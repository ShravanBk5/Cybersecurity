# Splunk and Snort Alert Logs

Splunk is a powerful software platform used for searching, monitoring, and analyzing machine-generated data, including logs, events, and other types of data generated by various systems, applications, and devices. It provides organizations with the ability to gain valuable insights from their data, enabling them to make informed decisions, troubleshoot issues, detect anomalies, and improve operational efficiency.

## Objective

For my project, I plan to configure both Splunk and Snort. Afterwards, I will forward Snort logs to Splunk for analysis, leveraging Splunk's log aggregation and data normalization capabilities. This setup is used to learn about one of the capabilities of fully functional SIEM.

## Network Diagram

![Diagram](https://github.com/ShravanBk5/Cybersecurity/assets/68052087/831c8af8-539b-4657-a58a-1b880ed024bb)

## VM Instances

Create two VirtualBox instances: one with Ubuntu and the other with Ubuntu Server installed.

## Installation and configuration of Splunk in Ubuntu

Sign up for Splunk, once your account is verified, you can log in to the Splunk website and access your free Splunk instance.

Now, let's proceed with setting up Splunk on Ubuntu.

Download the Splunk .deb package. (Download the latest version from the website, `wget` command should look like this. But you can download other way too.)

```plaintext
wget -O splunk-9.2.0.1-d8ae995bf219-linux-2.6-amd64.deb "https://download.splunk.com/products/splunk/releases/9.2.0.1/linux/splunk-9.2.0.1-d8ae995bf219-linux-2.6-amd64.deb"
```

Install the .deb package.

```plaintext
sudo dpkg -i splunk-9.2.0.1-d8ae995bf219-linux-2.6-amd64.deb
```

Start Splunk

```plaintext
sudo /opt/splunk/bin/splunk start
```

Agree to the license agreement when prompted the first time you start Splunk.

To enable Splunk to launch on boot

```plaintext
sudo /opt/splunk/bin/splunk enable boot-start
```

That's it! Splunk is set on Ubuntu system. It can now be accessed via a web browser using the URL provided during the installation process (typically http://localhost:8000) and start using it for log management, data analysis, and more.

Once you login, Splunk should look like this.

![Screenshot 2024-03-04 204124](https://github.com/ShravanBk5/Cybersecurity/assets/68052087/5734738e-82c5-4c33-a64c-63dc11c06207)

Except for `Snort Alert for Splunk` that is installed.

![Screenshot 2024-03-04 204110](https://github.com/ShravanBk5/Cybersecurity/assets/68052087/cabca401-c0d7-4d35-ab22-5afa715ea02d)

To install the Snort app in Splunk and configure it to receive data

Navigate to "Apps" -> "Manage Apps".

In the search bar, enter "Snort Alert for Splunk" and click "Install" to install the Snort app for Splunk.

Then navigate to "Settings" -> "Forwarding and Receiving Data".

Click on "Configure receiving" to open the receiving data configuration page.

Specify the port for receiving data (e.g., port 9997) and click "Save".

After completing these steps, your Splunk instance will be configured to receive data from Snort. You can now start sending Snort alerts and logs to Splunk for analysis and visualization.

## Installation of Snort and Splunk Forwarder

To install Snort and Splunk Forwarder on Ubuntu Server.

Snort

```plaintext
sudo apt-get update
sudo apt-get install snort
```
Make changes to Snort configuration then start snort.


To install Splunk Universal Forwarder, download the Splunk Universal Forwarder package from the Splunk website.

```plaintext
sudo dpkg -i <splunk_forwarder_package.deb>
```
Open the `inputs.conf` file and add the following configuration to specify the inputs for Snort alerts.

```
sudo nano /opt/splunkforwarder/etc/system/local/inputs.conf
```
```
[monitor:///var/log/snort/alert]
disabled = false
index = main
sourcetype = snort_alerts
```
Edit the `outputs.conf` file to specify the IP address of the Splunk indexer. Which is the IP of Ubuntu instance and port number that is assigned to receive in Splunk.

```
sudo nano /opt/splunkforwarder/etc/system/local/outputs.conf
```
`outputs.conf` file should look like this.

```
defaultGroup = default-autolb-group

[tcpout:default-autolb-group]
server = 192.168...:9997

[tcpout-server://192.168...:9997]
```
Start Splunkforwarder to begin.
```
sudo /opt/splunkforwarder/bin/splunk start
```
## Splunk Monitoring

Once everything is set up and functioning properly, you can access Splunk to view the logs that have been received.

This is an example of Snort alerts generated by simulated DOS attack.

![Screenshot 2024-03-04 204014](https://github.com/ShravanBk5/Cybersecurity/assets/68052087/33ebc87d-df44-435e-8fe6-f48571595dbf)


![Screenshot 2024-03-04 204040](https://github.com/ShravanBk5/Cybersecurity/assets/68052087/e4c3e06d-102a-4cd2-bcbc-42e47c3fc4d2)

## Conclusion

In this project, I've successfully configured both Splunk and Snort on Ubuntu systems. By forwarding Snort alerts to Splunk for analysis, I've leveraged Splunk's powerful log aggregation and data normalization capabilities. This setup allowed me to gain valuable insights into our network security posture and learn about one of the capabilities of a fully functional Security Information and Event Management (SIEM) system.

With Splunk, organizations can effectively search, monitor, and analyze machine-generated data to make informed decisions, troubleshoot issues, detect anomalies, and improve operational efficiency. By integrating Snort alerts into Splunk, we enhance our ability to monitor and respond to security events in real-time.

Moving forward, this project will serve as a foundation for further exploration and experimentation with Splunk and other security monitoring tools.

Thank you for visiting this page, and I encourage you to explore and experiment with Splunk and Snort to deepen your knowledge of cybersecurity and SIEM technologies.
